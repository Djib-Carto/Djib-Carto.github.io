<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Nocturne ‚Äì Black Marble + Villes (Cesium)</title>

  <script src="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Widgets/widgets.css" rel="stylesheet"/>

  <style>
    html, body, #cesiumContainer {
      width:100%;
      height:100%;
      margin:0;
      padding:0;
      overflow:hidden;
      background:black;
    }

    #info {
      position:absolute;
      top:12px;
      left:12px;
      background:rgba(0,0,0,0.7);
      color:#fff;
      padding:10px 12px;
      border-radius:6px;
      font-family:Arial;
      font-size:13px;
    }

    /* ‚úÖ Signature cartographique */
    #credit {
      position:absolute;
      bottom:12px;
      right:12px;
      background:rgba(0,0,0,0.6);
      color:#ccc;
      padding:6px 10px;
      border-radius:4px;
      font-family:Arial, sans-serif;
      font-size:12px;
      z-index:10;
      pointer-events:none;
    }
  </style>
</head>

<body>
<div id="cesiumContainer"></div>

<div id="info">
  üåå <b>Carte nocturne</b><br>
  Black Marble + villes<br>
  Rendu optimis√© Cesium
</div>

<!-- ‚úÖ Cr√©dit -->
<div id="credit">
  ¬© Moustapha Farah
</div>

<script>
Cesium.Ion.defaultAccessToken = undefined;

// Viewer stable
const viewer = new Cesium.Viewer("cesiumContainer", {
  imageryProvider: false,
  terrainProvider: new Cesium.EllipsoidTerrainProvider(),
  animation:false,
  timeline:false,
  baseLayerPicker:false,
  geocoder:false,
  navigationHelpButton:false,
  homeButton:true
});

// Nettoyage visuel
viewer.scene.skyAtmosphere.show = false;
viewer.scene.globe.enableLighting = false;
viewer.scene.globe.showGroundAtmosphere = false;
viewer.scene.requestRenderMode = true;
viewer.scene.maximumRenderTimeChange = Infinity;

// üåå Black Marble (fond nocturne)
viewer.imageryLayers.addImageryProvider(
  new Cesium.WebMapTileServiceImageryProvider({
    url: "https://gibs.earthdata.nasa.gov/wmts/epsg3857/best/wmts.cgi",
    layer: "VIIRS_Black_Marble",
    style: "",
    format: "image/png",
    tileMatrixSetID: "GoogleMapsCompatible_Level8",
    maximumLevel: 8,
    credit: "NASA GIBS ‚Äì Black Marble"
  })
);

// üåü Villes lumineuses (illusion haute r√©solution)
Cesium.GeoJsonDataSource.load(
  "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world_population.geojson"
).then(ds => {
  viewer.dataSources.add(ds);

  ds.entities.values.forEach(e => {
    if (e.properties && e.properties.pop) {
      const pop = e.properties.pop.getValue();
      e.point = new Cesium.PointGraphics({
        pixelSize: Math.min(10, Math.log(pop) * 2),
        color: Cesium.Color.GOLD.withAlpha(0.9),
        outlineColor: Cesium.Color.ORANGE,
        outlineWidth: 1
      });
    }
  });
});

// üåç Vue naturelle Afrique
viewer.camera.setView({
  destination: Cesium.Cartesian3.fromDegrees(
    20, 5, 25000000
  ),
  orientation: {
    heading: 0,
    pitch: Cesium.Math.toRadians(-90),
    roll: 0
  }
});
</script>

</body>
</html>
